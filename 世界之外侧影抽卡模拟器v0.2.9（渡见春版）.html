<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>ä¾§å½±æŠ½å¡æ¨¡æ‹Ÿå™¨ï¼ˆæ¸¡è§æ˜¥ç‰ˆï¼‰</title>
    <style>
        /* åŸºæœ¬èƒŒæ™¯å’Œæ–‡å­—é¢œè‰² */
        body {
            background-color: #35373F; /* æ·±ç°è‰²èƒŒæ™¯ */
            color: #e0e0e0; /* æµ…ç°è‰²æ–‡å­— */
            font-family: Arial, sans-serif; /* è®¾ç½®é»˜è®¤å­—ä½“ */
        }

        .text-center {
            text-align: center;
        }

        .container {
            width: 80%;
            margin: 0 auto;
            padding: 20px;
            box-sizing: border-box;
        }

        /* å“åº”å¼è®¾è®¡ */
        @media (max-width: 600px) {
            .container {
                width: 100%;
                padding: 10px;
            }
        }

        @media (min-width: 601px) and (max-width: 1024px) {
            .container {
                width: 90%;
            }
        }

        @media (min-width: 1025px) {
            .container {
                width: 80%;
            }
        }

        #drawButton {
            display: block;
            margin: 20px auto;
            background-color: #E9547C;
            color: white;
            padding: 20px 40px;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-size: 20px;
        }

        #drawButton:hover {
            background-color: #FE9900;
        }

        a {
            color: #bb86fc;
            text-decoration: none;
        }

        a:hover {
            text-decoration: underline;
        }

       .stats-row, .special-stats-row {
    display: flex;
    justify-content: space-between;
    margin-bottom: 10px; /* å‡å°‘äº†æ¯è¡Œä¹‹é—´çš„å¤–è¾¹è· */
}

.stats-row p, .special-stats-row p {
    flex: 1;
    margin: 0 5px; /* å‡å°‘äº†æ®µè½ä¹‹é—´çš„å¤–è¾¹è·ï¼Œä½¿å†…å®¹æ›´ç´§å‡‘ */
    padding: 5px; /* å†…è¾¹è·å‡å°‘ */
    font-size: 14px; /* å­—ä½“å¤§å°é€‚å½“è°ƒæ•´ */
    line-height: 1.4; /* è¡Œé«˜è°ƒæ•´ */
    background-color: #40424a; /* ç»™ç»Ÿè®¡æ•°æ®æ·»åŠ èƒŒæ™¯è‰²ä»¥å¢å¼ºåŒºåˆ†åº¦ */
    border-radius: 5px; /* è½»å¾®åœ†è§’æ•ˆæœ */
    text-align: center; /* æ–‡å­—å±…ä¸­æ˜¾ç¤º */
}

/* ç‰¹æ®Šç»Ÿè®¡è¡Œçš„æ ·å¼ */
.special-stats-row {
    display: flex;
    justify-content: space-between;
    margin-bottom: 10px; /* å‡å°‘äº†æ¯è¡Œä¹‹é—´çš„å¤–è¾¹è· */
}

.special-stats-row p {
    flex: 1;
    margin: 0 5px; /* å‡å°‘äº†æ®µè½ä¹‹é—´çš„å¤–è¾¹è·ï¼Œä½¿å†…å®¹æ›´ç´§å‡‘ */
    padding: 5px; /* å†…è¾¹è·å‡å°‘ */
    font-size: 14px; /* å­—ä½“å¤§å°é€‚å½“è°ƒæ•´ */
    line-height: 1.4; /* è¡Œé«˜è°ƒæ•´ */
    background-color: #40424a; /* ç»™ç»Ÿè®¡æ•°æ®æ·»åŠ èƒŒæ™¯è‰²ä»¥å¢å¼ºåŒºåˆ†åº¦ */
    border-radius: 5px; /* è½»å¾®åœ†è§’æ•ˆæœ */
    text-align: center; /* æ–‡å­—å±…ä¸­æ˜¾ç¤º */
}

/* ä¸–ç•Œä¾§å½±ç´¯è®¡æ•°çš„é¢œè‰² */
.world-color {
    color: #FFA500; /* æ©™è‰² */
}

/* æœˆä¾§å½±ç´¯è®¡æ•°çš„é¢œè‰² */
.moon-color {
    color: #BBA0E3; /* æ·¡ç´«è‰² */
}

/* æ˜Ÿä¾§å½±ç´¯è®¡æ•°çš„é¢œè‰² */
.star-color {
    color: #00BFFF; /* é’è“è‰² */
}

/* é«˜äº®æ˜¾ç¤ºä¸–ç•Œå¡ç‰Œ */
.world-card-highlight {
    color: #FFA500; /* æ©™è‰² */
    font-weight: bold; /* åŠ ç²— */
}

      .info-icon {
    cursor: help;
    font-size: 16px; /* æˆ–è€…ä»»ä½•é€‚åˆä½ è®¾è®¡çš„å¤§å° */
    margin-left: 5px; /* æ·»åŠ ä¸€ç‚¹å·¦è¾¹è·ä»¥ä¸å‰é¢çš„æ–‡å­—åˆ†å¼€ */
}
      #refreshButton {
    background: none;
    border: none;
    color: #e0e0e0;
    cursor: pointer;
    font-size: 20px; /* è°ƒæ•´å¤§å°ä»¥é€‚åº” */
}

      .special-world-card-highlight {
    color: #ffff66; /* æ©™é»„è‰² */
    font-weight: bold; /* å¯é€‰çš„ï¼Œå¦‚æœä½ æƒ³è¦æ–‡å­—åŠ ç²— */
}

    </style>
</head>
<body>
    <h2 class="text-center">ä¾§å½±æŠ½å¡æ¨¡æ‹Ÿå™¨ï¼ˆæ¸¡è§æ˜¥ç‰ˆï¼‰</h2>
    <h3 class="text-center">
      ä»…ä¾›å¨±ä¹ï¼Œç¥å¤§å®¶æ¬§æ°”æ»¡æ»¡á•™(`â–¿Â´)á•—
    <span class="info-icon" title="è¿™æ˜¯ä¸€ä¸ªæ¨¡æ‹Ÿæ¸¸æˆï¼Œç»“æœå¹¶ä¸çœŸå®">â„¹ï¸</span>
    </h3>
    <button id="drawButton">10è¿ä¸€å‘å…¥é­‚</button>
    <div id="statistics" class="text-center">
        <h3>ç»Ÿè®¡æ•°æ®</h3>
        <div class="stats-row">
            <p>æ€»æŠ½æ•°ï¼š<span id="totalDraws">0</span></p>
            <p><span class="world-color">ä¸–ç•Œä¾§å½±ç´¯è®¡ï¼š</span><span id="worldCards" class="world-color">0</span></p>
          
        </div>
        <div class="stats-row">
            <p><span class="moon-color">æœˆä¾§å½±ç´¯è®¡ï¼š</span><span id="moonCards" class="moon-color">0</span></p>
            <p><span class="star-color">æ˜Ÿä¾§å½±ç´¯è®¡ï¼š</span><span id="starCards" class="star-color">0</span></p>
        </div>
        <h3>é™å®šä¾§å½±ç»Ÿè®¡æ•°æ®ï¼ˆå¼€å§‹æŠ½å¡åæ˜¾ç¤ºï¼‰</h3>
        <div id="specialCardsStats" class="special-stats-container"></div>
    </div>
    <!-- æ·»åŠ äº†æŠ½å¡å†å²è®°å½•çš„å…ƒç´  -->
    <h3 class="text-center">å†å²è®°å½• <button id="refreshButton" title=ç‚¹æˆ‘é‡å¼€>ğŸ”„</button></h3>
    <ul id="cardHistory" class="text-center"></ul>
    <script>
    const worldCardNames = [
'é•¿æ¢¦å°†é†’', 'è®¸ä½ é•¿å®‰', 'å¯æœ›ä¸å¯åŠ', 'é€¢é­”', 'å­˜åœ¨ä¸æ¶ˆå¼­', 'å‡æµ·æˆå†°', 'é‚£å¤œé£è½»', 'ä¸´åˆ«', 'èŠ±å¥½æœˆåœ†', 'åŠ å†•æ—¶åˆ»', 'å¾…ä½ å½’æ¥', 'ä¸æ¬¢æ›´ä½•å¾…', 'å¦„å¿µ', 'é›¨ä¸­æš‚åˆ«', 'åˆå¤œå·²è‡³', 'å¿ƒè¡Œåƒä¸‡é‡Œ', 'ä¸è§‰æ—¥é•¿', 'å†°æµ·', 'é£é›ªå½’äºº', 'å¤œéœœä¾µæ€€', 'é¥è·¯ç”ŸèŠ±', 'å› ç¼˜ä½•é”™', 'çŸ¥æˆ‘æš—æ¶Œ', 'æ…ˆæ‚²ä¸æ¸¡'
];
const specialWorldCards = ['é¥è·¯ç”ŸèŠ±', 'å› ç¼˜ä½•é”™', 'çŸ¥æˆ‘æš—æ¶Œ', 'æ…ˆæ‚²ä¸æ¸¡'];
let recentCards = [], totalDraws = 0, stats = { world: 0, moon: 0, star: 0, special: {} };

specialWorldCards.forEach(card => stats.special[card] = 0);

document.getElementById('drawButton').addEventListener('click', function() {
let cardsDrawn = drawCards();
updateHistory(cardsDrawn);
updateStatistics();
});
      
function drawCards() {
    let cardsDrawn = [], worldDrawn = false, moonDrawn = false;
    let guaranteeDrawIndex = Math.floor(Math.random() * 10); // åœ¨10è¿ä¸­éšæœºé€‰æ‹©ä¸€æ¬¡ä½œä¸ºä¿åº•æŠ½å–
    let hasWorldInLast60 = recentCards.slice(-60).some(card => card.includes("ä¸–ç•Œ"));
    let is70thDraw = ((totalDraws + 10) % 70 === 0); // æ£€æŸ¥æ˜¯å¦æ˜¯ç¬¬70æ¬¡æŠ½å–

    for (let i = 0; i < 10; i++) {
        let card;
        if ((i === guaranteeDrawIndex && !hasWorldInLast60 && totalDraws >= 60) || (is70thDraw && !worldDrawn && i === 9)) {
            // è¿ç»­60æ¬¡æ²¡æœ‰æŠ½åˆ°æˆ–è€…ç¬¬70æ¬¡æŠ½å–æ—¶ä¿åº•å‡ºä¸–ç•Œå¡
            card = drawWorldCard();
            worldDrawn = true;
        } else if (i === guaranteeDrawIndex && !worldDrawn) {
            // ä¿åº•é€»è¾‘ï¼Œæ ¹æ®98%çš„æ¦‚ç‡æŠ½å–æœˆå¡ï¼Œ2%çš„æ¦‚ç‡æŠ½å–ä¸–ç•Œå¡
            card = Math.random() < 0.02 ? drawWorldCard() : drawMoonCard();
            if (card.includes("ä¸–ç•Œ")) worldDrawn = true;
            else moonDrawn = true;
        } else {
            card = drawRandomCard();
            if (card.includes("ä¸–ç•Œ")) worldDrawn = true;
            else if (card.includes("æœˆ")) moonDrawn = true;
        }

        cardsDrawn.push(card);
    }

    // æ›´æ–°æŠ½å¡è®°å½•
    recentCards.push(...cardsDrawn);
    // ä¿æŒrecentCardsä»…è®°å½•æœ€è¿‘60æ¬¡æŠ½å¡ç»“æœ
    if (recentCards.length > 60) recentCards = recentCards.slice(-60);
    totalDraws += 10;

// ç‰¹æ®Šæƒ…å†µï¼šä»…åœ¨ç¬¬100æ¬¡æŠ½å–æ—¶ï¼Œæ·»åŠ ä¸€ä¸ªé¢å¤–çš„é™å®šä¸–ç•Œå¡
if (totalDraws === 100) {
    let specialCard = drawSpecialWorldCard();
    cardsDrawn.push(specialCard); // æ·»åŠ åˆ°æŠ½å¡ç»“æœä¸­
}

    // è¿”å›æœ¬æ¬¡æŠ½å¡ç»“æœ
    return cardsDrawn;
}



function drawRandomCard() {
let rand = Math.random();
if (rand < 0.02) return drawWorldCard();
else if (rand < 0.12) return drawMoonCard();
else return drawStarCard();
}

function drawSpecialCard(guaranteeWorld) {
return guaranteeWorld ? drawWorldCard() : (Math.random() < 0.02 ? drawWorldCard() : drawMoonCard());
}

let lastWorldCardSpecial = false; // è¿½è¸ªä¸Šä¸€æ¬¡æ˜¯å¦æŠ½åˆ°é™å®šä¸–ç•Œå¡

function drawWorldCard() {
    let cardName, isSpecial;
    // é¦–æ¬¡æŠ½å¡æ—¶ï¼Œè®©é™å®šä¸éé™å®šä¸–ç•Œå¡çš„æœºä¼šå‡ç­‰
    let firstTimeWorldDraw = totalDraws === 0; // åˆ¤æ–­æ˜¯å¦ä¸ºé¦–æ¬¡æŠ½ä¸–ç•Œå¡

    let drawProbability = totalDraws <= 160 ? 0.5 : (totalDraws <= 260 ? 0.6 : (totalDraws <= 360 ? 0.75 : 1));

    if (firstTimeWorldDraw) {
        // å¦‚æœæ˜¯ç¬¬ä¸€æ¬¡æŠ½å–ä¸–ç•Œå¡ï¼Œé™å®šä¸éé™å®šçš„æ¦‚ç‡æ˜¯50-50
        isSpecial = Math.random() < 0.5;
    } else if (!lastWorldCardSpecial || Math.random() < drawProbability) {
        // å¦‚æœä¹‹å‰æ²¡æœ‰æŠ½åˆ°é™å®šä¸–ç•Œå¡æˆ–æ ¹æ®æ¦‚ç‡è®¡ç®—åº”è¯¥æŠ½åˆ°é™å®šå¡
        isSpecial = true;
    } else {
        // å¦åˆ™ï¼Œè¿™æ¬¡ä¸æŠ½å–é™å®šä¸–ç•Œå¡
        isSpecial = false;
    }

    if (isSpecial) {
        cardName = specialWorldCards[Math.floor(Math.random() * specialWorldCards.length)];
    } else {
        let nonSpecialWorldCards = worldCardNames.filter(name => !specialWorldCards.includes(name));
        cardName = nonSpecialWorldCards[Math.floor(Math.random() * nonSpecialWorldCards.length)];
    }

    let card = `ä¸–ç•Œï¼ˆ${cardName}ï¼‰`;
    stats.world++;
    if (isSpecial) {
        stats.special[cardName] = (stats.special[cardName] || 0) + 1;
        lastWorldCardSpecial = true;
    } else {
        lastWorldCardSpecial = false;
    }

    return card;
}



function drawMoonCard() {
stats.moon++;
return "æœˆ";
}

function drawStarCard() {
stats.star++;
return "æ˜Ÿ";
}
      
      function drawSpecialWorldCard() {
    let cardName = specialWorldCards[Math.floor(Math.random() * specialWorldCards.length)];
    let card = `ä¸–ç•Œï¼ˆ${cardName}ï¼‰`;
    stats.world++;
    stats.special[cardName] = (stats.special[cardName] || 0) + 1;
    return card;
}


function updateHistory(cards) {
    let historyElement = document.getElementById('cardHistory');
    let listItem = document.createElement('li');
    let batchNumber = totalDraws / 10;
    listItem.innerHTML = `${batchNumber} - æŠ½åˆ°ï¼š` + cards.map((card, index) => {
        let isSpecialWorldCard = index === 10; // æ£€æŸ¥æ˜¯å¦ä¸ºé¢å¤–çš„é™å®šå¡
        if (card.includes("ä¸–ç•Œ")) {
            return `<span class="${isSpecialWorldCard ? 'special-world-card-highlight' : 'world-card-highlight'}">${card}</span>`;
        } else {
            return card;
        }
    }).join(', ');
    historyElement.appendChild(listItem);
}



function updateStatistics() {
document.getElementById('totalDraws').textContent = totalDraws;
document.getElementById('worldCards').textContent = stats.world;
document.getElementById('moonCards').textContent = stats.moon;
document.getElementById('starCards').textContent = stats.star;

// æ›´æ–°é™å®šä¾§å½±ç»Ÿè®¡æ•°æ®
updateSpecialStats(); // ç¡®ä¿è¿™è¡Œä»£ç è¢«æ·»åŠ 
}

function updateSpecialStats() {
let specialStatsElement = document.getElementById('specialCardsStats');
specialStatsElement.innerHTML = ''; // æ¸…ç©ºç°æœ‰ç»Ÿè®¡æ•°æ®
let entries = Object.keys(stats.special);
for (let i = 0; i < entries.length; i += 2) {
let row = document.createElement('div');
row.className = 'special-stats-row';

let entry1 = document.createElement('p');
entry1.textContent = `${entries[i]}ç´¯è®¡ï¼š${stats.special[entries[i]]}`;
row.appendChild(entry1);

if (i + 1 < entries.length) {
let entry2 = document.createElement('p');
entry2.textContent = `${entries[i + 1]}ç´¯è®¡ï¼š${stats.special[entries[i + 1]]}`;
row.appendChild(entry2);
}

specialStatsElement.appendChild(row);
}
}
      document.getElementById('refreshButton').addEventListener('click', function() {
  location.reload();
});

function drawExtraSpecialWorldCard() {
    let cardName = specialWorldCards[Math.floor(Math.random() * specialWorldCards.length)];
    let card = `ä¸–ç•Œï¼ˆ${cardName}ï¼‰`;
    stats.world++;
    stats.special[cardName] = (stats.special[cardName] || 0) + 1;
    return card;
}

    </script>
</body>
</html>
